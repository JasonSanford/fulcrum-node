{"version":3,"sources":["../src/index.js"],"names":["email","password","options","generateAuthOptions","api","get","body","user","contexts","map","context","api_token","getUser","organizationId","note","timeout","length","userId","authorizationObj","authorization","organization_id","user_id","post","createAuthorization","Client","Page","Fetcher","baseURI","encoded","base64","encode","headers"],"mappings":";;;;;;;;;;;;;;;;sFAyBO,iBAAuBA,KAAvB,EAA8BC,QAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,mBADD,GACWC,oBAAoBH,KAApB,EAA2BC,QAA3B,CADX;AAAA;AAAA,mBAGcG,IAAIC,GAAJ,CAAQ,QAAR,EAAkBH,OAAlB,CAHd;;AAAA;AAGCI,gBAHD;AAKGC,gBALH,GAKYD,IALZ,CAKGC,IALH;;;AAOLA,iBAAKC,QAAL,GAAgBD,KAAKC,QAAL,CAAcC,GAAd,CAAkB,UAACC,OAAD,EAAa;AAC7C;AACA;AACA;AACA,qBAAOA,QAAQC,SAAf;;AAEA,qBAAOD,OAAP;AACD,aAPe,CAAhB;;AAPK,6CAgBEH,IAhBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeK,O;;;;;;uFAmBf,kBAAmCZ,KAAnC,EAA0CC,QAA1C,EAAoDY,cAApD,EAAoEC,IAApE,EAA0EC,OAA1E;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACL,gBAAI,OAAUC,MAAV,KAAqB,CAAzB,EAA4B;AAAA,uBACoChB,KADpC;AACvBA,mBADuB,UACvBA,KADuB;AAChBC,sBADgB,UAChBA,QADgB;AACNY,4BADM,UACNA,cADM;AACUC,kBADV,UACUA,IADV;AACgBC,qBADhB,UACgBA,OADhB;AACyBE,oBADzB,UACyBA,MADzB;AAE3B;;AAEKC,4BALD,GAKoB;AACvBC,6BAAe;AACbC,iCAAiBP,cADJ;AAEbQ,yBAASJ,MAFI;AAGbH,sBAAMA,IAHO;AAIbC,yBAASA;AAJI;AADQ,aALpB;AAcCb,mBAdD,GAcWC,oBAAoBH,KAApB,EAA2BC,QAA3B,CAdX;;;AAgBLC,oBAAQI,IAAR,GAAeY,gBAAf;;AAhBK;AAAA,mBAkBcd,IAAIkB,IAAJ,CAAS,iBAAT,EAA4BpB,OAA5B,CAlBd;;AAAA;AAkBCI,gBAlBD;AAAA,8CAoBEA,KAAKa,aApBP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeI,mB;;;;;AA5CtB;;;;AAEA;;;;AACA;;;;AACA;;;;;;QAESC,M,GAAAA,gB;QACAC,I,GAAAA,c;;;AAET,IAAMrB,MAAM,IAAIsB,iBAAJ,CAAY;AACtBC,WAAS;AADa,CAAZ,CAAZ;;AAIA,SAASxB,mBAAT,CAA6BH,KAA7B,EAAoCC,QAApC,EAA8C;AAC5C,MAAM2B,UAAUC,eAAOC,MAAP,CAAiB9B,KAAjB,SAA0BC,QAA1B,CAAhB;;AAEA,SAAO;AACL8B,aAAS;AACP,kCAA0BH,OADnB;AAEP,gBAAU,kBAFH;AAGP,sBAAgB;AAHT;AADJ,GAAP;AAOD","file":"index.js","sourcesContent":["import base64 from 'base-64';\n\nimport Fetcher from './fetcher';\nimport Client from './client';\nimport Page from './page';\n\nexport { Client };\nexport { Page };\n\nconst api = new Fetcher({\n  baseURI: 'https://api.fulcrumapp.com/api/v2'\n});\n\nfunction generateAuthOptions(email, password) {\n  const encoded = base64.encode(`${email}:${password}`);\n\n  return {\n    headers: {\n      'Authorization': `Basic ${encoded}`,\n      'Accept': 'application/json',\n      'Content-Type': 'application/json'\n    }\n  };\n}\n\nexport async function getUser(email, password) {\n  const options = generateAuthOptions(email, password);\n\n  const body = await api.get('/users', options);\n\n  const { user } = body;\n\n  user.contexts = user.contexts.map((context) => {\n    // To avoid confusion remove the old API tokens. These will\n    // be deprecated eventually, and authorizations have been\n    // the way to create tokens for a while now.\n    delete context.api_token;\n\n    return context;\n  });\n\n  return user;\n}\n\nexport async function createAuthorization(email, password, organizationId, note, timeout) {\n  if (arguments.length === 1) {\n    ({ email, password, organizationId, note, timeout, userId } = email);\n  }\n\n  const authorizationObj = {\n    authorization: {\n      organization_id: organizationId,\n      user_id: userId,\n      note: note,\n      timeout: timeout\n    }\n  };\n\n  const options = generateAuthOptions(email, password);\n\n  options.body = authorizationObj;\n\n  const body = await api.post('/authorizations', options);\n\n  return body.authorization;\n}\n"]}